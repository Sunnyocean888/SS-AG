<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sun Series Travel - Professional Quotation System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .hidden { display: none; }
        .show { display: block; }
    </style>
</head>
<body class="bg-gradient-to-br from-orange-50 to-yellow-50 min-h-screen">
    <div class="max-w-6xl mx-auto p-6">
        <div class="bg-white rounded-xl shadow-lg p-8">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-3xl font-bold text-orange-600 mb-2">Sun Series Travel Co., Ltd.</h1>
                <p class="text-gray-600">Professional Tour Quotation System - Thailand Specialist</p>
                <div class="flex justify-center items-center gap-4 mt-4 text-sm text-gray-500">
                    <span>Quote #: <span id="quote-number"></span></span>
                    <span>‚Ä¢</span>
                    <span>Valid Until: <span id="valid-until"></span></span>
                </div>
            </div>

            <!-- Client Information -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üë§ Client Information</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Client Name</label>
                        <input type="text" id="client-name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Full name">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                        <input type="email" id="client-email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="email@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
                        <input type="tel" id="client-phone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="+66 XX XXX XXXX">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nationality</label>
                        <input type="text" id="client-nationality" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Country">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Number of Guests</label>
                        <input type="number" id="group-size" value="1" min="1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                    </div>
                </div>
                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Special Requests</label>
                    <textarea id="special-requests" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="2" placeholder="Dietary restrictions, accessibility needs, preferences..."></textarea>
                </div>
            </div>

            <!-- Travel Dates -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üìÖ Travel Dates</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Start Date</label>
                        <input type="date" id="start-date" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">End Date (Auto-calculated)</label>
                        <input type="date" id="end-date" class="w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-600" readonly>
                    </div>
                </div>
            </div>

            <!-- Destinations -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üìç Destinations</h2>
                <div id="destinations-container">
                    <div class="destination-item p-4 bg-gray-50 rounded-lg mb-4">
                        <div class="flex gap-4 items-start">
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Destination 1</label>
                                <select class="destination-select w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                                    <option value="Bangkok">Bangkok</option>
                                    <option value="Phuket">Phuket</option>
                                    <option value="Chiang Mai">Chiang Mai</option>
                                    <option value="Krabi">Krabi</option>
                                </select>
                            </div>
                            <div class="w-28">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Nights</label>
                                <input type="number" class="nights-input w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-transparent" value="3" min="1" max="14">
                            </div>
                        </div>
                    </div>
                </div>
                <button onclick="addDestination()" class="px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 text-sm">+ Add Destination</button>
            </div>

            <!-- Tours -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üéØ Popular Tours</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="tours-container">
                    <!-- Bangkok Tours -->
                    <div class="tour-item p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-300" data-code="BKK-001" data-price="4450">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900 text-sm">BKK-001: Floating Market & Railway Market</h4>
                                <p class="text-xs text-gray-600 mt-1">Duration: 10 hours</p>
                                <p class="text-xs text-green-600 mt-1">‚úì Guide, transportation, lunch, entrance fees</p>
                            </div>
                            <div class="text-right">
                                <div class="text-orange-600 font-semibold text-sm">THB 4,450/person</div>
                                <div class="text-xs text-gray-500">for 2-3 guests</div>
                            </div>
                        </div>
                    </div>

                    <div class="tour-item p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-300" data-code="BKK-002" data-price="6450">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900 text-sm">BKK-002: Safari World & Dinner Cruise</h4>
                                <p class="text-xs text-gray-600 mt-1">Duration: 10 hours</p>
                                <p class="text-xs text-green-600 mt-1">‚úì Guide, transportation, lunch, dinner cruise</p>
                            </div>
                            <div class="text-right">
                                <div class="text-orange-600 font-semibold text-sm">THB 6,450/person</div>
                                <div class="text-xs text-gray-500">for 2-3 guests</div>
                            </div>
                        </div>
                    </div>

                    <div class="tour-item p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-300" data-code="HKT-001" data-price="2700">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900 text-sm">HKT-001: Phi Phi Island Tour</h4>
                                <p class="text-xs text-gray-600 mt-1">Duration: 7 hours</p>
                                <p class="text-xs text-green-600 mt-1">‚úì Speed boat, guide, lunch, snorkeling</p>
                            </div>
                            <div class="text-right">
                                <div class="text-orange-600 font-semibold text-sm">THB 2,700/person</div>
                                <div class="text-xs text-gray-500">for 2-3 guests</div>
                            </div>
                        </div>
                    </div>

                    <div class="tour-item p-4 border border-gray-200 rounded-lg cursor-pointer hover:border-orange-300" data-code="CNX-001" data-price="3155">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-900 text-sm">CNX-001: Doi Inthanon & Hill Tribe</h4>
                                <p class="text-xs text-gray-600 mt-1">Duration: 9 hours</p>
                                <p class="text-xs text-green-600 mt-1">‚úì Guide, transportation, lunch, entrance fees</p>
                            </div>
                            <div class="text-right">
                                <div class="text-orange-600 font-semibold text-sm">THB 3,155/person</div>
                                <div class="text-xs text-gray-500">for 2 guests</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hotels -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üè® Accommodation</h2>
                <div id="hotels-container">
                    <div class="hotel-item p-4 bg-gray-50 rounded-lg mb-4">
                        <div class="flex gap-4 items-start">
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Destination</label>
                                <select class="hotel-destination w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                    <option value="Bangkok">Bangkok</option>
                                    <option value="Phuket">Phuket</option>
                                    <option value="Chiang Mai">Chiang Mai</option>
                                    <option value="Krabi">Krabi</option>
                                </select>
                            </div>
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Hotel Category</label>
                                <select class="hotel-category w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                                    <option value="budget">Budget (3‚òÖ) - THB 1,500/night</option>
                                    <option value="standard" selected>Standard (4‚òÖ) - THB 2,800/night</option>
                                    <option value="deluxe">Deluxe (5‚òÖ) - THB 5,500/night</option>
                                    <option value="luxury">Luxury (5‚òÖ+) - THB 8,500/night</option>
                                </select>
                            </div>
                            <div class="w-32">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Rate/Night</label>
                                <input type="number" class="hotel-rate w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent" value="2800">
                            </div>
                        </div>
                    </div>
                </div>
                <button onclick="addHotel()" class="px-4 py-2 bg-purple-500 text-white rounded-md hover:bg-purple-600 text-sm">+ Add Hotel</button>
            </div>

            <!-- Pricing Settings -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üí∞ Pricing Settings</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Markup (%)</label>
                        <input type="number" id="markup" value="20" min="0" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Currency</label>
                        <select id="currency" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="THB">Thai Baht (THB)</option>
                            <option value="USD">US Dollar (USD)</option>
                            <option value="HKD">Hong Kong Dollar (HKD)</option>
                            <option value="EUR">Euro (EUR)</option>
                            <option value="GBP">British Pound (GBP)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Exchange Rate (to THB)</label>
                        <input type="number" id="exchange-rate" value="1" step="0.01" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                </div>
            </div>

            <!-- Cost Summary -->
            <div class="mb-8">
                <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                    <h3 class="text-lg font-semibold text-green-800 mb-4">Cost Summary</h3>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center py-2 border-b border-green-200">
                            <span class="text-gray-700">Airport Transfers:</span>
                            <span class="font-medium" id="transfers-cost">THB 0</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-green-200">
                            <span class="text-gray-700">Tours Total:</span>
                            <span class="font-medium" id="tours-cost">THB 0</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-green-200">
                            <span class="text-gray-700">Hotels Total:</span>
                            <span class="font-medium" id="hotels-cost">THB 0</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b-2 border-green-300 font-semibold">
                            <span class="text-gray-800">Subtotal:</span>
                            <span id="subtotal-cost">THB 0</span>
                        </div>
                        <div class="flex justify-between items-center py-2 border-b border-green-200">
                            <span class="text-blue-600">Markup (<span id="markup-percent">20</span>%):</span>
                            <span class="font-medium text-blue-600" id="markup-cost">THB 0</span>
                        </div>
                        <div class="bg-green-100 p-3 rounded-lg">
                            <div class="flex justify-between items-center">
                                <span class="text-lg font-bold text-green-800">FINAL AMOUNT:</span>
                                <span class="text-xl font-bold text-green-800" id="final-amount">THB 0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Summary Notes -->
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üìù Additional Notes</h2>
                <textarea id="summary-notes" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-transparent" rows="4" placeholder="Add any additional notes, special requirements, or terms & conditions..."></textarea>
            </div>

            <!-- Generate Button -->
            <div class="border-t pt-6">
                <div class="flex justify-center">
                    <button onclick="generateQuotation()" class="px-8 py-3 bg-gradient-to-r from-orange-500 to-yellow-500 text-white rounded-lg hover:from-orange-600 hover:to-yellow-600 font-semibold text-lg shadow-lg transform transition hover:scale-105">
                        üìÑ Generate Professional Quotation
                    </button>
                </div>
            </div>

            <!-- Generated Quotation Display -->
            <div id="quotation-display" class="mb-8 mt-8 hidden">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">üìã Generated Quotation</h2>
                <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-green-800">Professional Quotation Ready</h3>
                        <div class="space-x-2">
                            <button onclick="copyQuotation()" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 text-sm">Copy to Clipboard</button>
                            <button onclick="downloadQuotation()" class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-sm">Download</button>
                            <button onclick="closeQuotation()" class="px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 text-sm">Close</button>
                        </div>
                    </div>
                    <pre id="quotation-text" class="bg-white p-4 rounded border text-sm whitespace-pre-wrap font-mono max-h-96 overflow-y-auto"></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
            setupEventListeners();
        });

        function initializePage() {
            // Generate quote number
            const date = new Date();
            const number = `SST-${date.getFullYear()}${String(date.getMonth() + 1).padStart(2, '0')}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`;
            document.getElementById('quote-number').textContent = number;
            
            // Set valid until date (30 days from today)
            const validDate = new Date();
            validDate.setDate(validDate.getDate() + 30);
            document.getElementById('valid-until').textContent = validDate.toLocaleDateString('en-GB');
            
            calculateCosts();
        }

        function setupEventListeners() {
            // Add event listeners for automatic calculation
            document.getElementById('group-size').addEventListener('input', calculateCosts);
            document.getElementById('markup').addEventListener('input', function() {
                document.getElementById('markup-percent').textContent = this.value;
                calculateCosts();
            });
            document.getElementById('currency').addEventListener('change', updateExchangeRate);
            document.getElementById('exchange-rate').addEventListener('input', calculateCosts);
            
            // Tour selection
            document.querySelectorAll('.tour-item').forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.toggle('bg-orange-50');
                    this.classList.toggle('border-orange-500');
                    calculateCosts();
                });
            });

            // Date calculation
            document.getElementById('start-date').addEventListener('change', calculateEndDate);
            document.querySelectorAll('.nights-input').forEach(input => {
                input.addEventListener('input', calculateEndDate);
            });
        }

        function updateExchangeRate() {
            const currency = document.getElementById('currency').value;
            const rates = { THB: 1, USD: 35.5, HKD: 4.55, EUR: 38.2, GBP: 44.8 };
            document.getElementById('exchange-rate').value = rates[currency];
            calculateCosts();
        }

        function calculateEndDate() {
            const startDate = document.getElementById('start-date').value;
            if (!startDate) return;
            
            const nights = Array.from(document.querySelectorAll('.nights-input')).reduce((sum, input) => sum + parseInt(input.value || 0), 0);
            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + nights);
            document.getElementById('end-date').value = endDate.toISOString().split('T')[0];
        }

        function calculateCosts() {
            const groupSize = parseInt(document.getElementById('group-size').value) || 1;
            const markup = parseFloat(document.getElementById('markup').value) || 0;
            const exchangeRate = parseFloat(document.getElementById('exchange-rate').value) || 1;
            const currency = document.getElementById('currency').value;
            
            // Calculate destinations for transfers
            const destinations = document.querySelectorAll('.destination-item').length;
            const transfersCost = destinations * 2 * 1500; // 2 transfers per destination
            
            // Calculate tours cost
            const selectedTours = document.querySelectorAll('.tour-item.bg-orange-50');
            let toursCost = 0;
            selectedTours.forEach(tour => {
                const price = parseInt(tour.dataset.price);
                toursCost += price * groupSize;
            });
            
            // Calculate hotels cost
            const hotels = document.querySelectorAll('.hotel-item');
            let hotelsCost = 0;
            hotels.forEach((hotel, index) => {
                const rate = parseInt(hotel.querySelector('.hotel-rate').value) || 0;
                const nights = parseInt(document.querySelectorAll('.nights-input')[0]?.value) || 3; // Default to first destination nights
                hotelsCost += rate * nights;
            });
            
            const subtotal = transfersCost + toursCost + hotelsCost;
            const markupAmount = subtotal * (markup / 100);
            const totalWithMarkup = subtotal + markupAmount;
            const finalAmount = totalWithMarkup / exchangeRate;
            
            // Update display
            const currencySymbol = currency === 'USD' ? '$' : currency === 'HKD' ? 'HK$' : currency === 'EUR' ? '‚Ç¨' : currency === 'GBP' ? '¬£' : 'THB ';
            
            document.getElementById('transfers-cost').textContent = `THB ${transfersCost.toLocaleString()}`;
            document.getElementById('tours-cost').textContent = `THB ${toursCost.toLocaleString()}`;
            document.getElementById('hotels-cost').textContent = `THB ${hotelsCost.toLocaleString()}`;
            document.getElementById('subtotal-cost').textContent = `THB ${subtotal.toLocaleString()}`;
            document.getElementById('markup-cost').textContent = `THB ${markupAmount.toLocaleString()}`;
            document.getElementById('final-amount').textContent = `${currencySymbol}${finalAmount.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
        }

        function addDestination() {
            const container = document.getElementById('destinations-container');
            const count = container.children.length + 1;
            if (count > 4) return;
            
            const newDestination = document.createElement('div');
            newDestination.className = 'destination-item p-4 bg-gray-50 rounded-lg mb-4';
            newDestination.innerHTML = `
                <div class="flex gap-4 items-start">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Destination ${count}</label>
                        <select class="destination-select w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-transparent">
                            <option value="Bangkok">Bangkok</option>
                            <option value="Phuket">Phuket</option>
                            <option value="Chiang Mai">Chiang Mai</option>
                            <option value="Krabi">Krabi</option>
                        </select>
                    </div>
                    <div class="w-28">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Nights</label>
                        <input type="number" class="nights-input w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-orange-500 focus:border-transparent" value="2" min="1" max="14">
                    </div>
                    <button onclick="removeDestination(this)" class="text-red-500 hover:text-red-700 p-2 mt-6">‚úï</button>
                </div>
            `;
            container.appendChild(newDestination);
            
            // Add event listener for new nights input
            newDestination.querySelector('.nights-input').addEventListener('input', calculateEndDate);
            calculateCosts();
        }

        function removeDestination(button) {
            button.closest('.destination-item').remove();
            calculateCosts();
        }

        function addHotel() {
            const container = document.getElementById('hotels-container');
            const newHotel = document.createElement('div');
            newHotel.className = 'hotel-item p-4 bg-gray-50 rounded-lg mb-4';
            newHotel.innerHTML = `
                <div class="flex gap-4 items-start">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Destination</label>
                        <select class="hotel-destination w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="Bangkok">Bangkok</option>
                            <option value="Phuket">Phuket</option>
                            <option value="Chiang Mai">Chiang Mai</option>
                            <option value="Krabi">Krabi</option>
                        </select>
                    </div>
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Hotel Category</label>
                        <select class="hotel-category w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="budget">Budget (3‚òÖ) - THB 1,500/night</option>
                            <option value="standard" selected>Standard (4‚òÖ) - THB 2,800/night</option>
                            <option value="deluxe">Deluxe (5‚òÖ) - THB 5,500/night</option>
                            <option value="luxury">Luxury (5‚òÖ+) - THB 8,500/night</option>
                        </select>
                    </div>
                    <div class="w-32">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Rate/Night</label>
                        <input type="number" class="hotel-rate w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent" value="2800">
                    </div>
                    <button onclick="removeHotel(this)" class="text-red-500 hover:text-red-700 p-2 mt-6">‚úï</button>
                </div>
            `;
            container.appendChild(newHotel);
            
            // Add event listener for new hotel rate input
            newHotel.querySelector('.hotel-rate').addEventListener('input', calculateCosts);
            calculateCosts();
        }

        function removeHotel(button) {
            button.closest('.hotel-item').remove();
            calculateCosts();
        }

        function generateQuotation() {
            // Gather all data
            const clientName = document.getElementById('client-name').value || 'N/A';
            const clientEmail = document.getElementById('client-email').value || 'N/A';
            const clientPhone = document.getElementById('client-phone').value || 'N/A';
            const clientNationality = document.getElementById('client-nationality').value || 'N/A';
            const specialRequests = document.getElementById('special-requests').value;
            const groupSize = document.getElementById('group-size').value;
            const startDate = document.getElementById('start-date').value;
            const endDate = document.getElementById('end-date').value;
            const quoteNumber = document.getElementById('quote-number').textContent;
            const validUntil = document.getElementById('valid-until').textContent;
            const summaryNotes = document.getElementById('summary-notes').value;
            
            // Get selected tours
            const selectedTours = Array.from(document.querySelectorAll('.tour-item.bg-orange-50')).map(tour => {
                const title = tour.querySelector('h4').textContent;
                const duration = tour.querySelector('.text-xs').textContent;
                return `‚Ä¢ ${title}\n  ${duration}`;
            });
            
            // Get destinations
            const destinations = Array.from(document.querySelectorAll('.destination-select')).map((select, index) => {
                const nights = document.querySelectorAll('.nights-input')[index].value;
                return `${select.value} (${nights} nights)`;
            });
            
            // Get hotels
            const hotels = Array.from(document.querySelectorAll('.hotel-item')).map(hotel => {
                const destination = hotel.querySelector('.hotel-destination').value;
                const category = hotel.querySelector('.hotel-category option:checked').textContent;
                const rate = hotel.querySelector('.hotel-rate').value;
                return `‚Ä¢ ${destination}: ${category} @ THB ${parseInt(rate).toLocaleString()}/night`;
            });
            
            // Calculate costs for quotation
            const transfersCost = document.getElementById('transfers-cost').textContent;
            const toursCost = document.getElementById('tours-cost').textContent;
            const hotelsCost = document.getElementById('hotels-cost').textContent;
            const subtotalCost = document.getElementById('subtotal-cost').textContent;
            const markupCost = document.getElementById('markup-cost').textContent;
            const finalAmount = document.getElementById('final-amount').textContent;
            const markup = document.getElementById('markup').value;
            
            // Generate quotation text
            const quotationText = `
SUN SERIES TRAVEL CO., LTD.
QUOTATION FOR THAILAND TOUR PACKAGE
=====================================

QUOTATION NO: ${quoteNumber}
DATE: ${new Date().toLocaleDateString('en-GB')}
VALID UNTIL: ${validUntil}

CLIENT INFORMATION:
==================
Name: ${clientName}
Email: ${clientEmail}
Phone: ${clientPhone}
Nationality: ${clientNationality}

TOUR DETAILS:
=============
Group Size: ${groupSize} guest(s)
Travel Period: ${startDate} to ${endDate}
Destinations: ${destinations.join(', ')}

SELECTED TOURS:
===============
${selectedTours.length > 0 ? selectedTours.join('\n\n') : 'No tours selected'}

ACCOMMODATION:
==============
${hotels.length > 0 ? hotels.join('\n') : 'No hotels specified'}

COST BREAKDOWN:
===============
Airport Transfers: ${transfersCost}
Tours Total: ${toursCost}
Hotels Total: ${hotelsCost}

Subtotal: ${subtotalCost}
Markup (${markup}%): ${markupCost}

FINAL AMOUNT: ${finalAmount}

${specialRequests ? `\nSPECIAL REQUESTS:\n================\n${specialRequests}\n` : ''}
${summaryNotes ? `\nADDITIONAL NOTES:\n================\n${summaryNotes}\n` : ''}

TERMS & CONDITIONS:
==================
‚Ä¢ This quotation is valid until ${validUntil}
‚Ä¢ Prices are subject to change based on hotel availability and seasonal rates
‚Ä¢ Full payment required 7 days before departure
‚Ä¢ Cancellation policy applies as per company terms
‚Ä¢ All tours are subject to weather conditions

CONTACT INFORMATION:
===================
Sun Series Travel Co., Ltd.
Email: info@sunseriestravel.com
Phone: +66 (0) 2-XXX-XXXX
License: TAT License No. XXXX

Generated on: ${new Date().toLocaleDateString('en-GB')} ${new Date().toLocaleTimeString('en-GB')}
`;

            // Display quotation
            document.getElementById('quotation-text').textContent = quotationText;
            document.getElementById('quotation-display').classList.remove('hidden');
            document.getElementById('quotation-display').scrollIntoView({ behavior: 'smooth' });
        }

        function copyQuotation() {
            const quotationText = document.getElementById('quotation-text').textContent;
            navigator.clipboard.writeText(quotationText).then(() => {
                alert('Quotation copied to clipboard!');
            });
        }

        function downloadQuotation() {
            const quotationText = document.getElementById('quotation-text').textContent;
            const quoteNumber = document.getElementById('quote-number').textContent;
            const blob = new Blob([quotationText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Quotation_${quoteNumber}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        function closeQuotation() {
            document.getElementById('quotation-display').classList.add('hidden');
        }
    </script>
</body>
</html>
